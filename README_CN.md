# 游戏宏 - AutoHotkey 自动化工具

一个基于 AutoHotkey v2 开发的高级游戏自动化工具，支持像素检测、技能循环、BUFF计时、DXGI屏幕捕获、旋转引擎等强大的功能。

## 功能特性

### 🎯 核心功能
- **高级像素检测**：支持 DXGI 屏幕捕获、ROI 检测、GDI 备用方案
- **多线程支持**：多个独立的技能执行线程配合工作池管理
- **智能避让**：自动鼠标避让功能，防止取色时干扰游戏操作
- **规则引擎**：基于条件的自动化规则系统，支持像素和计数器条件
- **BUFF计时器**：自动续BUFF功能，支持优先级执行
- **DXGI 屏幕捕获**：使用 DirectX Graphics Infrastructure 的高性能屏幕捕获
- **旋转管理**：复杂的技能循环序列，支持开场、轨道、门控机制
- **国际化**：多语言支持，配置化语言包
- **自动化页面**：完整的线程、BUFF、规则和循环管理界面
- **实时监控**：实时状态监控，包含摘要页面和详细列表

### 🛠️ 配置管理
- **多角色配置**：独立的 JSON 格式配置文件，支持不同游戏角色
- **可视化编辑**：完整的图形界面配置技能、点位、规则和旋转
- **配置导出**：可将配置打包为独立脚本
- **国际化支持**：多语言界面，基于 INI 的语言包系统
- **模块化架构**：组织良好的代码结构，便于维护和扩展
- **技能管理**：全面的技能编辑器，支持像素检测配置
- **点位管理**：颜色检测点位配置，支持容差控制
- **规则系统**：高级规则编辑器，支持条件和动作配置
- **旋转编辑器**：复杂的循环序列，支持多阶段配置

## 快速开始

### 选项1：便携版EXE（推荐新手使用）
1. **下载最新发布版本**：从 `releases/` 文件夹下载ZIP文件
2. **解压ZIP文件**：解压到任意目录
3. **运行 `game-macro.exe`**：无需安装，直接运行

### 选项2：源代码版本（适合开发者）
#### 系统要求
- **Windows 操作系统**
- **AutoHotkey v2.0 或更高版本**
- **DirectX 11 兼容显卡**（用于 DXGI 屏幕捕获）

#### 安装步骤
1. 下载并安装 [AutoHotkey v2](https://www.autohotkey.com/)
2. 克隆或下载此项目到本地
3. 双击 `Main.ahk` 启动配置工具

### 基本使用流程
1. **启动工具**：运行 `Main.ahk` 打开配置界面
2. **创建配置**：点击"新建"创建角色配置
3. **配置技能**：在"技能列表"标签页添加技能
4. **设置旋转**：配置技能循环序列（可选）
5. **创建规则**：设置条件触发的自动化规则（可选）
6. **配置BUFF**：添加自动续BUFF计时器（可选）
7. **设置热键**：配置开始/停止热键（默认：F9）
8. **保存配置**：点击"保存配置"按钮
9. **开始使用**：在游戏中按热键启动宏

## 详细配置

### 技能配置
每个技能包含以下参数：
- **技能名**：自定义名称
- **键位**：游戏中的技能快捷键
- **坐标**：技能图标在屏幕上的位置
- **颜色**：技能冷却完成时的像素颜色
- **容差**：颜色匹配的容差范围

### 点位配置
独立的取色点位，可用于检测游戏状态：
- **名称**：点位描述
- **坐标**：屏幕坐标
- **颜色**：预期颜色值
- **容差**：颜色匹配容差

### 规则系统
基于条件的自动化规则：
- **条件**：像素检测、计数器等条件判断
- **动作**：执行技能、延迟等操作
- **线程**：指定执行线程
- **优先级**：规则执行优先级

### BUFF计时器
自动续BUFF功能：
- **BUFF名称**：自定义名称
- **持续时间**：BUFF持续时间（毫秒）
- **提前刷新**：提前刷新时间
- **关联技能**：用于续BUFF的技能

## 项目架构

项目采用模块化架构设计，各模块职责明确，便于维护和扩展：

- **核心模块** (`core/`): 应用配置管理和核心系统功能
- **引擎模块** (`engines/`): 像素检测、规则处理、BUFF管理、旋转管理、DXGI捕获等
- **UI模块** (`ui/`): 图形界面框架、页面管理、对话框组件
- **运行时模块** (`runtime/`): 热键处理、轮询系统、计数器管理
- **存储模块** (`storage/`): 配置导出和数据存储
- **国际化模块** (`i18n/`): 多语言支持
- **工具模块** (`util/`): 通用工具函数
- **工作模块** (`workers/`): 工作池管理

详细的项目结构和实现请参考 `docs/` 目录下的文档。

## 使用示例

### 基本技能循环
1. 添加需要循环使用的技能
2. 设置技能检测坐标和颜色
3. 配置轮询间隔（默认25ms）
4. 设置全局延迟防止技能刷屏

### 条件触发规则
1. 创建规则并设置条件
2. 配置条件满足时的动作
3. 设置规则优先级和冷却时间
4. 指定执行线程

### BUFF自动续费
1. 添加BUFF计时器
2. 设置BUFF持续时间和提前刷新时间
3. 关联续BUFF的技能
4. 配置检测条件

## 注意事项

### ⚠️ 重要提醒
- 本工具仅供学习和研究使用
- 请遵守游戏服务条款，合理使用自动化功能
- 过度使用可能导致账号风险
- 建议在单人游戏或允许的环境中使用

### 🔧 技术限制
- 依赖屏幕像素检测，分辨率变化需要重新配置
- 游戏更新可能导致配置失效
- 不支持全屏独占模式的游戏

## 开发说明

### 扩展开发
项目采用模块化设计，易于扩展新功能：
- 新增模块只需在 `Main.ahk` 中包含
- 遵循现有的命名和接口规范
- 使用全局 `App` Map 进行状态管理

### 调试技巧
- 查看 `Logs/` 目录下的日志文件
- 使用测试功能验证技能检测
- 调整容差参数优化检测准确性

## 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件。

### 许可证摘要

MIT 许可证是一个宽松的开源许可证，允许：
- ✅ 商业使用
- ✅ 修改和分发
- ✅ 私人使用
- ✅ 包含在专有软件中

唯一的要求是保留原始的版权声明和许可证文本。

### 重要提醒

虽然本软件是开源的，但请负责任地使用：
- 遵守游戏服务条款
- 仅在允许的环境中使用自动化功能
- 避免影响其他玩家的游戏体验

## 更新日志

### v0.0.3 (当前版本)
- **DXGI 屏幕捕获引擎**：集成高性能 DirectX 屏幕捕获功能
- **高级旋转系统**：支持开场、轨道、门控的复杂技能循环
- **规则引擎升级**：增强的条件判断和动作执行系统
- **多语言支持**：完整的国际化系统，支持中英文切换
- **模块化重构**：更清晰的代码架构和模块划分

### v0.0.1-Alpha-0.2
- **UI框架增强**：添加完整的自动化管理页面
- **实时监控**：实现线程、BUFF和规则的摘要页面
- **布局优化**：改进UI布局计算，提升视觉效果
- **动态高度计算**：基于内容增强GroupBox高度计算
- **按钮定位优化**：优化按钮位置，提升用户体验

### v0.0.1-Alpha-0.1
- 初始版本发布
- 基础技能检测功能
- 图形化配置界面
- 规则引擎和BUFF计时器

## 贡献

欢迎提交 Issue 和 Pull Request 来改进项目。

## 支持

如有问题请查看：
1. 检查日志文件中的错误信息
2. 验证技能坐标和颜色配置
3. 确认游戏窗口未被遮挡
4. 调整检测参数优化准确性

---

**English Version**: [README.md](README.md)