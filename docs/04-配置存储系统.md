# é…ç½®å­˜å‚¨ç³»ç»Ÿ - Configuration and Storage System Documentation

## æ¦‚è¿°

é…ç½®å­˜å‚¨ç³»ç»Ÿæ˜¯Game Macroçš„æ•°æ®ç®¡ç†å±‚ï¼Œè´Ÿè´£ç»Ÿä¸€ç®¡ç†åº”ç”¨ç¨‹åºçš„å„ç±»é…ç½®ä¿¡æ¯ã€ç”¨æˆ·æ•°æ®å’Œç³»ç»ŸçŠ¶æ€ã€‚ç³»ç»Ÿé‡‡ç”¨åˆ†å±‚å­˜å‚¨æ¶æ„ï¼Œæ”¯æŒå¤šç§é…ç½®æ ¼å¼å’Œå­˜å‚¨æ–¹å¼ï¼Œæä¾›äº†å®Œæ•´çš„é…ç½®è¯»å†™ã€éªŒè¯ã€å¤‡ä»½å’Œå¯¼å‡ºåŠŸèƒ½ã€‚

## ç³»ç»Ÿæ¶æ„

### æ ¸å¿ƒç»„ä»¶

1. **Storage.ahk** - å­˜å‚¨ç®¡ç†æ ¸å¿ƒæ¨¡å—
2. **AppConfig.ini** - å…¨å±€åº”ç”¨é…ç½®æ–‡ä»¶  
3. **Exporter.ahk** - é…ç½®å¯¼å‡ºåŠŸèƒ½æ¨¡å—

### å­˜å‚¨å±‚æ¬¡ç»“æ„

```
é…ç½®å­˜å‚¨ç³»ç»Ÿ
â”œâ”€â”€ å…¨å±€åº”ç”¨é…ç½® (AppConfig.ini)
â”‚   â”œâ”€â”€ ç¨‹åºè®¾ç½® (Program Settings)
â”‚   â”œâ”€â”€ è¯­è¨€è®¾ç½® (Language Settings) 
â”‚   â””â”€â”€ UIçŠ¶æ€ (UI State)
â”œâ”€â”€ ç”¨æˆ·é…ç½®æ–‡ä»¶ (User Profiles)
â”‚   â”œâ”€â”€ è§’è‰²é…ç½® (Character Profiles)
â”‚   â”œâ”€â”€ æŠ€èƒ½é…ç½® (Skill Configurations)
â”‚   â”œâ”€â”€ ç‚¹ä½é…ç½® (Location Configurations)
â”‚   â”œâ”€â”€ Buffé…ç½® (Buff Configurations)
â”‚   â”œâ”€â”€ è½®æ¢è½¨é“ (Rotation Tracks)
â”‚   â”œâ”€â”€ è§„åˆ™é…ç½® (Rule Configurations)
â”‚   â””â”€â”€ çº¿ç¨‹é…ç½® (Thread Configurations)
â””â”€â”€ ç³»ç»ŸçŠ¶æ€æ–‡ä»¶ (System State Files)
    â”œâ”€â”€ è¿è¡ŒçŠ¶æ€ (Runtime State)
    â”œâ”€â”€ ä¸´æ—¶æ•°æ® (Temporary Data)
    â””â”€â”€ ç¼“å­˜æ•°æ® (Cached Data)
```

## 1. å­˜å‚¨ç®¡ç†æ ¸å¿ƒ - Storage.ahk

### æ ¸å¿ƒåŠŸèƒ½

Storageæ¨¡å—æä¾›ç»Ÿä¸€çš„é…ç½®ç®¡ç†æ¥å£ï¼Œæ”¯æŒINIæ ¼å¼çš„é…ç½®æ–‡ä»¶è¯»å†™å’Œç®¡ç†ã€‚

**ä¸»è¦ç‰¹æ€§**:
- **å¤šé…ç½®æ–‡ä»¶ç®¡ç†**: æ”¯æŒåŒæ—¶ç®¡ç†å¤šä¸ªé…ç½®æ–‡ä»¶
- **ç»“æ„åŒ–æ•°æ®å­˜å‚¨**: æ”¯æŒå¤æ‚çš„åµŒå¥—é…ç½®ç»“æ„
- **ç±»å‹å®‰å…¨**: è‡ªåŠ¨ç±»å‹è½¬æ¢å’ŒéªŒè¯
- **å¤‡ä»½æœºåˆ¶**: è‡ªåŠ¨é…ç½®å¤‡ä»½å’Œæ¢å¤
- **åŠ å¯†æ”¯æŒ**: å¯é€‰çš„é…ç½®åŠ å¯†åŠŸèƒ½

### æ ¸å¿ƒæ•°æ®ç»“æ„

```autohotkey
; å­˜å‚¨ç³»ç»Ÿå…¨å±€çŠ¶æ€
global Storage := {
    ConfigFiles: Map(),        // é…ç½®æ–‡ä»¶æ˜ å°„
    DefaultPaths: Map(),       // é»˜è®¤è·¯å¾„æ˜ å°„
    LoadedProfiles: Map(),     // å·²åŠ è½½é…ç½®æ–‡ä»¶
    BackupDir: "",             // å¤‡ä»½ç›®å½•
    CacheEnabled: true,        // ç¼“å­˜å¯ç”¨çŠ¶æ€
    Version: "1.0"            // å­˜å‚¨ç³»ç»Ÿç‰ˆæœ¬
}

; é»˜è®¤è·¯å¾„é…ç½®
Storage.DefaultPaths := {
    AppConfig: A_ScriptDir "\AppConfig.ini",
    UserProfiles: A_ScriptDir "\config",
    BackupDir: A_ScriptDir "\backup",
    Exports: A_ScriptDir "\exports"
}

; é…ç½®æ¨¡æ¿ç»“æ„
Storage.Templates := {
    Profile: {
        General: {
            Name: "",
            Description: "",
            Created: "",
            Modified: ""
        },
        Skills: {},
        Spots: {},
        Buffs: {},
        Rules: {},
        Rotation: {}
    }
}
```

### æ ¸å¿ƒå‡½æ•°è¯¦è§£

#### åˆå§‹åŒ–å­˜å‚¨ç³»ç»Ÿ

**Storage_Init()**
```autohotkey
; åˆå§‹åŒ–å­˜å‚¨ç³»ç»Ÿ
Storage_Init() {
    global Storage
    
    ; åˆ›å»ºå¿…è¦çš„ç›®å½•
    Storage_CreateDirectories()
    
    ; åŠ è½½é»˜è®¤é…ç½®æ–‡ä»¶
    Storage_LoadDefaultConfig()
    
    ; åˆå§‹åŒ–å¤‡ä»½ç³»ç»Ÿ
    Storage_InitBackupSystem()
    
    ; è®¾ç½®é»˜è®¤é…ç½®
    Storage_SetDefaultValues()
    
    Storage_Log("å­˜å‚¨ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ")
}

; åˆ›å»ºå¿…è¦çš„ç›®å½•
Storage_CreateDirectories() {
    dirs := [
        Storage.DefaultPaths.UserProfiles,
        Storage.DefaultPaths.BackupDir,
        Storage.DefaultPaths.Exports
    ]
    
    for dir in dirs {
        if !DirExist(dir) {
            try {
                DirCreate(dir)
                Storage_Log("åˆ›å»ºç›®å½•: " dir)
            } catch error {
                Storage_Log("åˆ›å»ºç›®å½•å¤±è´¥: " dir " - " error.message)
            }
        }
    }
}
```

#### é…ç½®æ–‡ä»¶ç®¡ç†

**Storage_LoadConfig()**
```autohotkey
; åŠ è½½é…ç½®æ–‡ä»¶
Storage_LoadConfig(configName, filePath := "") {
    global Storage
    
    ; ç¡®å®šæ–‡ä»¶è·¯å¾„
    if (filePath == "")
        filePath := Storage_ResolveConfigPath(configName)
    
    if !FileExist(filePath) {
        Storage_Log("é…ç½®æ–‡ä»¶ä¸å­˜åœ¨: " filePath)
        return false
    }
    
    try {
        ; åˆ›å»ºé…ç½®å¯¹è±¡
        config := {}
        config.Name := configName
        config.FilePath := filePath
        config.Loaded := A_Now
        config.Checksum := Storage_CalculateChecksum(filePath)
        
        ; è¯»å–é…ç½®èŠ‚
        config.Sections := Storage_ReadAllSections(filePath)
        
        ; ç¼“å­˜é…ç½®
        Storage.LoadedProfiles.Set(configName, config)
        
        Storage_Log("é…ç½®æ–‡ä»¶åŠ è½½æˆåŠŸ: " configName " -> " filePath)
        return config
    } catch error {
        Storage_Log("é…ç½®æ–‡ä»¶åŠ è½½å¤±è´¥: " error.message)
        return false
    }
}

; è¯»å–æ‰€æœ‰é…ç½®èŠ‚
Storage_ReadAllSections(filePath) {
    sections := Map()
    
    try {
        ; è¯»å–Iniæ–‡ä»¶çš„æ‰€æœ‰èŠ‚
        ini := FileRead(filePath, "UTF-8")
        lines := StrSplit(ini, "`n", "`r")
        
        currentSection := ""
        
        for line in lines {
            line := Trim(line)
            
            ; è·³è¿‡æ³¨é‡Šå’Œç©ºè¡Œ
            if (line == "" || SubStr(line, 1, 1) == ";")
                continue
            
            ; æ£€æŸ¥èŠ‚å¤´ [SectionName]
            if (RegExMatch(line, "^\[(.+)\]$", &match)) {
                currentSection := match[1]
                sections[currentSection] := Map()
                continue
            }
            
            ; è§£æé”®å€¼å¯¹ Key=Value
            if (currentSection != "" && InStr(line, "=")) {
                pos := InStr(line, "=")
                key := Trim(SubStr(line, 1, pos - 1))
                value := Trim(SubStr(line, pos + 1))
                
                if (key != "")
                    sections[currentSection][key] := value
            }
        }
        
        return sections
    } catch error {
        Storage_Log("è¯»å–é…ç½®èŠ‚å¤±è´¥: " error.message)
        return Map()
    }
}
```

**Storage_SaveConfig()**
```autohotkey
; ä¿å­˜é…ç½®æ–‡ä»¶
Storage_SaveConfig(configName, configData, backup := true) {
    global Storage
    
    try {
        ; è·å–é…ç½®è·¯å¾„
        if !Storage.LoadedProfiles.Has(configName) {
            Storage_Log("é…ç½®ä¸å­˜åœ¨: " configName)
            return false
        }
        
        config := Storage.LoadedProfiles[configName]
        filePath := config.FilePath
        
        ; å¤‡ä»½åŸæ–‡ä»¶
        if (backup) {
            Storage_BackupConfig(filePath)
        }
        
        ; æ„å»ºé…ç½®æ–‡ä»¶å†…å®¹
        content := Storage_BuildConfigContent(configData)
        
        ; å†™å…¥æ–‡ä»¶
        FileAppend(content, filePath, "UTF-8")
        
        ; æ›´æ–°é…ç½®å¯¹è±¡
        config.Loaded := A_Now
        config.Checksum := Storage_CalculateChecksum(filePath)
        config.Modified := true
        
        Storage_Log("é…ç½®æ–‡ä»¶ä¿å­˜æˆåŠŸ: " configName)
        return true
    } catch error {
        Storage_Log("é…ç½®æ–‡ä»¶ä¿å­˜å¤±è´¥: " error.message)
        return false
    }
}

; æ„å»ºé…ç½®æ–‡ä»¶å†…å®¹
Storage_BuildConfigContent(configData) {
    content := ""
    
    ; æ·»åŠ æ–‡ä»¶å¤´éƒ¨ä¿¡æ¯
    content .= "; Game Macroé…ç½®æ–‡ä»¶`n"
    content .= "; ç”Ÿæˆæ—¶é—´: " FormatTime(A_Now, "yyyy-MM-dd HH:mm:ss") "`n"
    content .= "; ç‰ˆæœ¬: " Storage.Version "`n`n"
    
    ; æ„å»ºå„ä¸ªèŠ‚
    for sectionName, sectionData in configData {
        content .= "[" sectionName "]`n"
        
        if IsObject(sectionData) {
            for key, value in sectionData {
                ; å¤„ç†ä¸åŒæ•°æ®ç±»å‹
                if (IsObject(value)) {
                    ; å¤åˆæ•°æ®ç±»å‹
                    content .= Storage_SerializeComplexData(key, value)
                } else {
                    ; åŸºæœ¬æ•°æ®ç±»å‹
                    content .= key "=" value "`n"
                }
            }
        }
        
        content .= "`n"
    }
    
    return content
}
```

#### æ—‹è½¬è½¨é“ç®¡ç†

**Storage_ListRotationTracks()**
```autohotkey
; åˆ—å‡ºæ‰€æœ‰æ—‹è½¬è½¨é“
Storage_ListRotationTracks(profileName := "") {
    global Storage
    
    tracks := []
    
    try {
        if (profileName != "") {
            ; è·å–ç‰¹å®šé…ç½®æ–‡ä»¶çš„è½¨é“
            config := Storage_GetProfile(profileName)
            if (config && config.Sections.Has("RotationTracks")) {
                tracks := Storage_ParseRotationTracks(config.Sections["RotationTracks"])
            }
        } else {
            ; è·å–æ‰€æœ‰è½¨é“
            for configName, config in Storage.LoadedProfiles {
                if (config.Sections.Has("RotationTracks")) {
                    trackList := Storage_ParseRotationTracks(config.Sections["RotationTracks"])
                    
                    ; ä¸ºæ¯ä¸ªè½¨é“æ·»åŠ é…ç½®æ–‡ä»¶ä¿¡æ¯
                    for track in trackList {
                        track.SourceConfig := configName
                        tracks.Push(track)
                    }
                }
            }
        }
        
        return tracks
    } catch error {
        Storage_Log("åˆ—å‡ºæ—‹è½¬è½¨é“å¤±è´¥: " error.message)
        return []
    }
}

; è§£ææ—‹è½¬è½¨é“æ•°æ®
Storage_ParseRotationTracks(sectionData) {
    tracks := []
    
    try {
        for key, value in sectionData {
            if InStr(key, "Track_") {
                track := Storage_ParseSingleTrack(value)
                track.Name := SubStr(key, 7)  ; ç§»é™¤ "Track_" å‰ç¼€
                tracks.Push(track)
            }
        }
        
        return tracks
    } catch error {
        Storage_Log("è§£ææ—‹è½¬è½¨é“å¤±è´¥: " error.message)
        return []
    }
}

; è§£æå•ä¸ªè½¨é“æ•°æ®
Storage_ParseSingleTrack(trackData) {
    track := {
        Name: "",
        Steps: [],
        Enabled: true,
        Description: ""
    }
    
    try {
        ; è§£æJSONæ ¼å¼çš„è½¨é“æ•°æ®
        ; è¿™é‡Œå‡è®¾è½¨é“æ•°æ®ä¸ºJSONæ ¼å¼
        parsed := JSON.Parse(trackData)
        
        track.Name := parsed.Has("name") ? parsed["name"] : ""
        track.Steps := parsed.Has("steps") ? parsed["steps"] : []
        track.Enabled := parsed.Has("enabled") ? parsed["enabled"] : true
        track.Description := parsed.Has("description") ? parsed["description"] : ""
        
        return track
    } catch {
        ; å¤‡ç”¨è§£ææ–¹æ¡ˆï¼šé€—å·åˆ†éš”çš„æ­¥éª¤åˆ—è¡¨
        track.Steps := StrSplit(trackData, ",", " ")
        track.Name := "Unnamed_" A_TickCount
        return track
    }
}
```

#### é—¨é…ç½®ç®¡ç†

**Storage_ListGates()**
```autohotkey
; åˆ—å‡ºæ‰€æœ‰é—¨é…ç½®
Storage_ListGates(profileName := "") {
    global Storage
    
    gates := []
    
    try {
        if (profileName != "") {
            ; è·å–ç‰¹å®šé…ç½®æ–‡ä»¶çš„é—¨
            config := Storage_GetProfile(profileName)
            if (config && config.Sections.Has("Gates")) {
                gates := Storage_ParseGates(config.Sections["Gates"])
            }
        } else {
            ; è·å–æ‰€æœ‰é—¨é…ç½®
            for configName, config in Storage.LoadedProfiles {
                if (config.Sections.Has("Gates")) {
                    gateList := Storage_ParseGates(config.Sections["Gates"])
                    
                    ; ä¸ºæ¯ä¸ªé—¨æ·»åŠ é…ç½®æ–‡ä»¶ä¿¡æ¯
                    for gate in gateList {
                        gate.SourceConfig := configName
                        gates.Push(gate)
                    }
                }
            }
        }
        
        return gates
    } catch error {
        Storage_Log("åˆ—å‡ºé—¨é…ç½®å¤±è´¥: " error.message)
        return []
    }
}

; è§£æé—¨é…ç½®æ•°æ®
Storage_ParseGates(sectionData) {
    gates := []
    
    try {
        for key, value in sectionData {
            if InStr(key, "Gate_") {
                gate := Storage_ParseSingleGate(value)
                gate.Name := SubStr(key, 5)  ; ç§»é™¤ "Gate_" å‰ç¼€
                gates.Push(gate)
            }
        }
        
        return gates
    } catch error {
        Storage_Log("è§£æé—¨é…ç½®å¤±è´¥: " error.message)
        return []
    }
}

; è§£æå•ä¸ªé—¨é…ç½®
Storage_ParseSingleGate(gateData) {
    gate := {
        Name: "",
        Type: "teleport",
        Position: {x: 0, y: 0},
        Enabled: true,
        Conditions: []
    }
    
    try {
        ; è§£æJSONæ ¼å¼çš„é—¨æ•°æ®
        parsed := JSON.Parse(gateData)
        
        gate.Name := parsed.Has("name") ? parsed["name"] : ""
        gate.Type := parsed.Has("type") ? parsed["type"] : "teleport"
        
        if (parsed.Has("position") && IsObject(parsed["position"])) {
            gate.Position := {
                x: parsed["position"].Has("x") ? parsed["position"]["x"] : 0,
                y: parsed["position"].Has("y") ? parsed["position"]["y"] : 0
            }
        }
        
        gate.Enabled := parsed.Has("enabled") ? parsed["enabled"] : true
        gate.Conditions := parsed.Has("conditions") ? parsed["conditions"] : []
        
        return gate
    } catch {
        ; å¤‡ç”¨è§£ææ–¹æ¡ˆ
        gate.Name := "Unnamed_" A_TickCount
        gate.Type := "teleport"
        return gate
    }
}
```

#### å®Œæ•´é…ç½®æ–‡ä»¶ç®¡ç†

**Storage_LoadFullProfile()**
```autohotkey
; åŠ è½½å®Œæ•´çš„ç”¨æˆ·é…ç½®æ–‡ä»¶
Storage_LoadFullProfile(profileName) {
    global Storage
    
    try {
        ; åŠ è½½é…ç½®æ–‡ä»¶
        config := Storage_LoadConfig(profileName)
        if !config
            return false
        
        ; è§£æå„ä¸ªé…ç½®èŠ‚
        profile := {
            General: Storage_ParseGeneralSection(config.Sections),
            Skills: Storage_ParseSkillsSection(config.Sections),
            Spots: Storage_ParseSpotsSection(config.Sections),
            Buffs: Storage_ParseBuffsSection(config.Sections),
            Rules: Storage_ParseRulesSection(config.Sections),
            Rotation: Storage_ParseRotationSection(config.Sections),
            Threads: Storage_ParseThreadsSection(config.Sections),
            Gates: Storage_ParseGatesSection(config.Sections),
            RotationTracks: Storage_ParseRotationTracks(config.Sections)
        }
        
        ; éªŒè¯é…ç½®æ–‡ä»¶å®Œæ•´æ€§
        if !Storage_ValidateProfile(profile) {
            Storage_Log("é…ç½®æ–‡ä»¶éªŒè¯å¤±è´¥: " profileName)
            return false
        }
        
        ; ç¼“å­˜å®Œæ•´é…ç½®æ–‡ä»¶
        Storage.FullProfiles ??= Map()
        Storage.FullProfiles[profileName] := profile
        
        Storage_Log("å®Œæ•´é…ç½®æ–‡ä»¶åŠ è½½æˆåŠŸ: " profileName)
        return profile
    } catch error {
        Storage_Log("åŠ è½½å®Œæ•´é…ç½®æ–‡ä»¶å¤±è´¥: " error.message)
        return false
    }
}

; è§£æé€šç”¨è®¾ç½®èŠ‚
Storage_ParseGeneralSection(sections) {
    general := {
        ProfileName: "",
        Description: "",
        Version: "1.0",
        Author: "",
        Created: "",
        Modified: "",
        Language: "zh-CN"
    }
    
    if sections.Has("General") {
        generalSection := sections["General"]
        
        general.ProfileName := generalSection.Has("ProfileName") ? generalSection["ProfileName"] : ""
        general.Description := generalSection.Has("Description") ? generalSection["Description"] : ""
        general.Version := generalSection.Has("Version") ? generalSection["Version"] : "1.0"
        general.Author := generalSection.Has("Author") ? generalSection["Author"] : ""
        general.Created := generalSection.Has("Created") ? generalSection["Created"] : ""
        general.Modified := generalSection.Has("Modified") ? generalSection["Modified"] : ""
        general.Language := generalSection.Has("Language") ? generalSection["Language"] : "zh-CN"
    }
    
    return general
}

; è§£ææŠ€èƒ½é…ç½®èŠ‚
Storage_ParseSkillsSection(sections) {
    skills := Map()
    
    if sections.Has("Skills") {
        skillsSection := sections["Skills"]
        
        for skillKey, skillValue in skillsSection {
            skill := Storage_ParseSkillData(skillValue)
            skills[skillKey] := skill
        }
    }
    
    return skills
}

; è§£æå•ä¸ªæŠ€èƒ½æ•°æ®
Storage_ParseSkillData(skillData) {
    skill := {
        Name: "",
        Type: "normal",
        Key: "",
        Cooldown: 0,
        CastTime: 0,
        ManaCost: 0,
        Enabled: true,
        Conditions: []
    }
    
    try {
        ; å°è¯•JSONè§£æ
        parsed := JSON.Parse(skillData)
        
        for key, value in parsed {
            if skill.Has(key) {
                skill[key] := value
            }
        }
    } catch {
        ; å¤‡ç”¨è§£æï¼šé”®å€¼å¯¹æ ¼å¼
        parts := StrSplit(skillData, "|")
        
        for part in parts {
            if InStr(part, "=") {
                pos := InStr(part, "=")
                key := Trim(SubStr(part, 1, pos - 1))
                value := Trim(SubStr(part, pos + 1))
                
                if skill.Has(key) {
                    ; ç±»å‹è½¬æ¢
                    if (key == "Cooldown" || key == "CastTime" || key == "ManaCost") {
                        skill[key] := Integer(value)
                    } else if (key == "Enabled") {
                        skill[key] := (value == "1" || value == "true")
                    } else {
                        skill[key] := value
                    }
                }
            }
        }
    }
    
    return skill
}
```

#### å¤‡ä»½ç³»ç»Ÿ

**Storage_BackupConfig()**
```autohotkey
; å¤‡ä»½é…ç½®æ–‡ä»¶
Storage_BackupConfig(filePath) {
    global Storage
    
    try {
        ; ç”Ÿæˆå¤‡ä»½æ–‡ä»¶å
        fileName := FileBase(filePath)
        ext := FileExt(filePath)
        backupName := fileName "_" FormatTime(A_Now, "yyyyMMdd_HHmmss") "." ext
        backupPath := Storage.DefaultPaths.BackupDir "\" backupName
        
        ; å¤åˆ¶æ–‡ä»¶è¿›è¡Œå¤‡ä»½
        FileCopy(filePath, backupPath, true)
        
        Storage_Log("é…ç½®æ–‡ä»¶å·²å¤‡ä»½: " backupPath)
        
        ; æ¸…ç†æ—§å¤‡ä»½ï¼ˆä¿ç•™æœ€è¿‘10ä¸ªï¼‰
        Storage_CleanupOldBackups(fileName)
        
        return backupPath
    } catch error {
        Storage_Log("å¤‡ä»½é…ç½®æ–‡ä»¶å¤±è´¥: " error.message)
        return false
    }
}

; æ¸…ç†æ—§å¤‡ä»½
Storage_CleanupOldBackups(fileName) {
    global Storage
    
    try {
        backupDir := Storage.DefaultPaths.BackupDir
        pattern := backupDir "\" fileName "_*.ini"
        
        ; è·å–æ‰€æœ‰åŒ¹é…çš„å¤‡ä»½æ–‡ä»¶
        backupFiles := []
        
        Loop Files, pattern, F  ; æ–‡ä»¶
        {
            backupFiles.Push(A_LoopFileFullPath)
        }
        
        ; æŒ‰ä¿®æ”¹æ—¶é—´æ’åº
        backupFiles.Sort()
        
        ; ä¿ç•™æœ€è¿‘çš„10ä¸ªï¼Œåˆ é™¤å…¶ä½™çš„
        while (backupFiles.Length > 10) {
            oldFile := backupFiles[1]  ; æœ€æ—§çš„æ–‡ä»¶
            try {
                FileDelete(oldFile)
                backupFiles.RemoveAt(1)
                Storage_Log("åˆ é™¤æ—§å¤‡ä»½: " oldFile)
            } catch {
                ; å¿½ç•¥åˆ é™¤å¤±è´¥
                backupFiles.RemoveAt(1)
            }
        }
    } catch error {
        Storage_Log("æ¸…ç†æ—§å¤‡ä»½å¤±è´¥: " error.message)
    }
}
```

### è¾…åŠ©åŠŸèƒ½

#### è·¯å¾„è§£æ

**Storage_ResolveConfigPath()**
```autohotkey
; è§£æé…ç½®æ–‡ä»¶è·¯å¾„
Storage_ResolveConfigPath(configName) {
    global Storage
    
    ; æ£€æŸ¥æ˜¯å¦ä¸ºç»å¯¹è·¯å¾„
    if InStr(configName, ":") || SubStr(configName, 1, 1) == "\"
        return configName
    
    ; ç›¸å¯¹è·¯å¾„å¤„ç†
    if !Storage.DefaultPaths.Has("UserProfiles")
        Storage.DefaultPaths.UserProfiles := A_ScriptDir "\config"
    
    return Storage.DefaultPaths.UserProfiles "\" configName ".ini"
}
```

#### æ ¡éªŒå’Œè®¡ç®—

**Storage_CalculateChecksum()**
```autohotkey
; è®¡ç®—æ–‡ä»¶æ ¡éªŒå’Œ
Storage_CalculateChecksum(filePath) {
    try {
        ; è¯»å–æ–‡ä»¶å†…å®¹
        content := FileRead(filePath)
        
        ; ç®€å•çš„å“ˆå¸Œè®¡ç®—ï¼ˆå®é™…åº”ç”¨ä¸­å¯ä½¿ç”¨æ›´å®‰å…¨çš„å“ˆå¸Œç®—æ³•ï¼‰
        hash := 0
        for char in StrSplit(content) {
            hash += Ord(char)
        }
        
        return Format("{:08X}", hash & 0xFFFFFFFF)
    } catch {
        return "00000000"
    }
}
```

#### æ—¥å¿—è®°å½•

**Storage_Log()**
```autohotkey
; å­˜å‚¨ç³»ç»Ÿæ—¥å¿—è®°å½•
Storage_Log(message) {
    timestamp := FormatTime(A_Now, "yyyy-MM-dd HH:mm:ss")
    logEntry := "[" timestamp "] [Storage] " message "`n"
    
    try {
        ; è¿½åŠ åˆ°æ—¥å¿—æ–‡ä»¶
        logPath := A_ScriptDir "\logs\storage.log"
        if !DirExist(A_ScriptDir "\logs") {
            DirCreate(A_ScriptDir "\logs")
        }
        
        FileAppend(logEntry, logPath, "UTF-8")
    } catch {
        ; æ—¥å¿—è®°å½•å¤±è´¥ä¸å½±å“ä¸»åŠŸèƒ½
    }
}
```

## 2. åº”ç”¨é…ç½®ç®¡ç† - AppConfig.ini

### é…ç½®ç»“æ„

AppConfig.iniå­˜å‚¨å…¨å±€åº”ç”¨ç¨‹åºè®¾ç½®ï¼ŒåŒ…æ‹¬ç¨‹åºé…ç½®ã€è¯­è¨€è®¾ç½®å’ŒUIçŠ¶æ€ç­‰ã€‚

**ä¸»è¦é…ç½®èŠ‚**:
- **[Program]** - ç¨‹åºåŸºæœ¬è®¾ç½®
- **[Language]** - è¯­è¨€é…ç½®
- **[UI]** - ç•Œé¢çŠ¶æ€
- **[Performance]** - æ€§èƒ½è®¾ç½®
- **[Debug]** - è°ƒè¯•é€‰é¡¹

### é…ç½®ç¤ºä¾‹

```ini
; Game Macro - å…¨å±€åº”ç”¨é…ç½®
; ç”Ÿæˆæ—¶é—´: 2024-12-19 14:30:15
; ç‰ˆæœ¬: 1.0

[Program]
Version=1.0.0
Name=Game Macro
Author=GameMacro Team
InstallPath=D:\project\AI\AHK\game-macro
DataPath=D:\project\AI\AHK\game-macro\data
LogLevel=INFO
AutoSave=true
BackupEnabled=true

[Language]
Current=zh-CN
Available=zh-CN|en-US
Default=zh-CN
ResourcePath=.\lang

[UI]
MainWindow=1
Width=1024
Height=768
Minimized=false
AlwaysOnTop=false
LanguageMenu=1

[Performance]
MaxThreads=4
WorkerPoolSize=8
CacheEnabled=true
BufferSize=1024
UpdateInterval=100

[Debug]
Enabled=false
LogToFile=true
VerboseMode=false
PerformanceMonitoring=false
```

### é…ç½®æ–‡ä»¶è¯»å†™

**é…ç½®è¯»å–å‡½æ•°**:
```autohotkey
; è¯»å–ç¨‹åºé…ç½®
AppConfig_GetProgramSetting(key, defaultValue := "") {
    return IniRead("Program", key, defaultValue, A_ScriptDir "\AppConfig.ini")
}

; è¯»å–è¯­è¨€é…ç½®
AppConfig_GetLanguageSetting(key, defaultValue := "") {
    return IniRead("Language", key, defaultValue, A_ScriptDir "\AppConfig.ini")
}

; è¯»å–UIé…ç½®
AppConfig_GetUISetting(key, defaultValue := "") {
    return IniRead("UI", key, defaultValue, A_ScriptDir "\AppConfig.ini")
}

; å†™å…¥é…ç½®
AppConfig_SetSetting(section, key, value) {
    return IniWrite(value, section, key, A_ScriptDir "\AppConfig.ini")
}
```

## 3. å¯¼å‡ºåŠŸèƒ½ç³»ç»Ÿ - Exporter.ahk

### æ ¸å¿ƒåŠŸèƒ½

Exporteræ¨¡å—æä¾›é…ç½®æ–‡ä»¶å¯¼å‡ºåŠŸèƒ½ï¼Œæ”¯æŒå°†å®Œæ•´çš„é…ç½®æ–‡ä»¶å’Œç›¸å…³èµ„æºæ‰“åŒ…å¯¼å‡ºåˆ°æŒ‡å®šç›®å½•ã€‚

**ä¸»è¦ç‰¹æ€§**:
- **å®Œæ•´å¯¼å‡º**: å¯¼å‡ºä¸»è„šæœ¬ã€é…ç½®å’ŒWorkerHost
- **ç›®å½•åˆ›å»º**: è‡ªåŠ¨åˆ›å»ºå¯¼å‡ºç›®å½•ç»“æ„
- **æ–‡ä»¶å¤åˆ¶**: æ™ºèƒ½æ–‡ä»¶å¤åˆ¶å’ŒéªŒè¯
- **è¯´æ˜ç”Ÿæˆ**: è‡ªåŠ¨ç”Ÿæˆä½¿ç”¨è¯´æ˜æ–‡æ¡£
- **æ ¼å¼æ”¯æŒ**: æ”¯æŒå¤šç§å¯¼å‡ºæ ¼å¼

### æ ¸å¿ƒå‡½æ•°è¯¦è§£

#### å¯¼å‡ºä¸»å‡½æ•°

**Exporter_ExportAll()**
```autohotkey
; å¯¼å‡ºæ‰€æœ‰ç»„ä»¶
Exporter_ExportAll(configName, targetPath) {
    try {
        ; éªŒè¯ç›®æ ‡è·¯å¾„
        if !Exporter_ValidateTargetPath(targetPath) {
            return false
        }
        
        ; åˆ›å»ºå¯¼å‡ºç›®å½•ç»“æ„
        Exporter_CreateExportStructure(targetPath)
        
        ; å¯¼å‡ºä¸»è„šæœ¬
        if !Exporter_ExportMainScript(targetPath) {
            Exporter_Log("ä¸»è„šæœ¬å¯¼å‡ºå¤±è´¥")
            return false
        }
        
        ; å¯¼å‡ºé…ç½®æ–‡ä»¶
        if !Exporter_ExportConfig(configName, targetPath) {
            Exporter_Log("é…ç½®æ–‡ä»¶å¯¼å‡ºå¤±è´¥")
            return false
        }
        
        ; å¯¼å‡ºWorkerHost
        if !Exporter_ExportWorkerHost(targetPath) {
            Exporter_Log("WorkerHostå¯¼å‡ºå¤±è´¥")
            return false
        }
        
        ; ç”Ÿæˆä½¿ç”¨è¯´æ˜
        Exporter_GenerateReadme(targetPath, configName)
        
        Exporter_Log("å¯¼å‡ºå®Œæˆ: " targetPath)
        return true
    } catch error {
        Exporter_Log("å¯¼å‡ºå¼‚å¸¸: " error.message)
        return false
    }
}
```

#### å¯¼å‡ºç›®å½•ç»“æ„åˆ›å»º

**Exporter_CreateExportStructure()**
```autohotkey
; åˆ›å»ºå¯¼å‡ºç›®å½•ç»“æ„
Exporter_CreateExportStructure(basePath) {
    directories := [
        basePath,
        basePath "\scripts",
        basePath "\config",
        basePath "\worker",
        basePath "\docs"
    ]
    
    for dir in directories {
        if !DirExist(dir) {
            try {
                DirCreate(dir)
                Exporter_Log("åˆ›å»ºç›®å½•: " dir)
            } catch error {
                Exporter_Log("åˆ›å»ºç›®å½•å¤±è´¥: " dir " - " error.message)
                return false
            }
        }
    }
    
    return true
}
```

#### ä¸»è„šæœ¬å¯¼å‡º

**Exporter_ExportMainScript()**
```autohotkey
; å¯¼å‡ºä¸»è„šæœ¬
Exporter_ExportMainScript(targetPath) {
    try {
        ; æŸ¥æ‰¾ä¸»è„šæœ¬æ–‡ä»¶
        mainScript := Exporter_FindMainScript()
        if !mainScript {
            Exporter_Log("æœªæ‰¾åˆ°ä¸»è„šæœ¬æ–‡ä»¶")
            return false
        }
        
        targetFile := targetPath "\scripts\" FileBase(mainScript) "." FileExt(mainScript)
        
        ; å¤åˆ¶ä¸»è„šæœ¬
        FileCopy(mainScript, targetFile, true)
        
        ; ä¿®æ”¹é…ç½®æ–‡ä»¶è·¯å¾„å¼•ç”¨
        Exporter_UpdateConfigPath(targetFile, "..\config")
        
        Exporter_Log("ä¸»è„šæœ¬å¯¼å‡ºæˆåŠŸ: " targetFile)
        return true
    } catch error {
        Exporter_Log("ä¸»è„šæœ¬å¯¼å‡ºå¤±è´¥: " error.message)
        return false
    }
}

; æŸ¥æ‰¾ä¸»è„šæœ¬
Exporter_FindMainScript() {
    ; æŸ¥æ‰¾å¯èƒ½çš„è„šæœ¬æ–‡ä»¶
    scriptFiles := [
        A_ScriptFullPath,
        A_ScriptDir "\main.ahk",
        A_ScriptDir "\GameMacro.ahk",
        A_ScriptDir "\macro.ahk"
    ]
    
    for scriptFile in scriptFiles {
        if FileExist(scriptFile) {
            return scriptFile
        }
    }
    
    return false
}
```

#### é…ç½®æ–‡ä»¶å¯¼å‡º

**Exporter_ExportConfig()**
```autohotkey
; å¯¼å‡ºé…ç½®æ–‡ä»¶
Exporter_ExportConfig(configName, targetPath) {
    global Storage
    
    try {
        ; è·å–é…ç½®å¯¹è±¡
        config := Storage_GetProfile(configName)
        if !config {
            Exporter_Log("é…ç½®æ–‡ä»¶ä¸å­˜åœ¨: " configName)
            return false
        }
        
        ; ç¡®å®šæºé…ç½®è·¯å¾„
        if Storage.LoadedProfiles.Has(configName) {
            sourcePath := Storage.LoadedProfiles[configName].FilePath
        } else {
            sourcePath := Storage_ResolveConfigPath(configName)
        }
        
        targetFile := targetPath "\config\" configName ".ini"
        
        ; å¤åˆ¶é…ç½®æ–‡ä»¶
        FileCopy(sourcePath, targetFile, true)
        
        ; å¯¼å‡ºç›¸å…³èµ„æºæ–‡ä»¶
        Exporter_ExportResourceFiles(configName, targetPath)
        
        Exporter_Log("é…ç½®æ–‡ä»¶å¯¼å‡ºæˆåŠŸ: " targetFile)
        return true
    } catch error {
        Exporter_Log("é…ç½®æ–‡ä»¶å¯¼å‡ºå¤±è´¥: " error.message)
        return false
    }
}
```

#### WorkerHostå¯¼å‡º

**Exporter_ExportWorkerHost()**
```autohotkey
; å¯¼å‡ºWorkerHost
Exporter_ExportWorkerHost(targetPath) {
    try {
        ; æŸ¥æ‰¾WorkerHostæ–‡ä»¶
        workerHost := Exporter_FindWorkerHost()
        if !workerHost {
            Exporter_Log("æœªæ‰¾åˆ°WorkerHostæ–‡ä»¶")
            return false
        }
        
        targetFile := targetPath "\worker\" FileBase(workerHost) "." FileExt(workerHost)
        
        ; å¤åˆ¶WorkerHost
        FileCopy(workerHost, targetFile, true)
        
        Exporter_Log("WorkerHostå¯¼å‡ºæˆåŠŸ: " targetFile)
        return true
    } catch error {
        Exporter_Log("WorkerHostå¯¼å‡ºå¤±è´¥: " error.message)
        return false
    }
}

; æŸ¥æ‰¾WorkerHost
Exporter_FindWorkerHost() {
    ; æŸ¥æ‰¾WorkerHostæ–‡ä»¶ï¼ˆexeæˆ–ahkï¼‰
    hostFiles := []
    
    ; æœç´¢exeæ–‡ä»¶
    Loop Files, A_ScriptDir "\worker\*.exe" {
        hostFiles.Push(A_LoopFileFullPath)
    }
    
    ; æœç´¢ahkæ–‡ä»¶
    Loop Files, A_ScriptDir "\worker\*.ahk" {
        hostFiles.Push(A_LoopFileFullPath)
    }
    
    ; è¿”å›ç¬¬ä¸€ä¸ªæ‰¾åˆ°çš„æ–‡ä»¶
    return hostFiles.Length > 0 ? hostFiles[1] : false
}
```

#### è¯´æ˜æ–‡æ¡£ç”Ÿæˆ

**Exporter_GenerateReadme()**
```autohotkey
; ç”ŸæˆREADMEè¯´æ˜æ–‡æ¡£
Exporter_GenerateReadme(targetPath, configName) {
    try {
        readmePath := targetPath "\README.md"
        
        ; ç”ŸæˆREADMEå†…å®¹
        content := Exporter_BuildReadmeContent(configName)
        
        ; å†™å…¥æ–‡ä»¶
        FileAppend(content, readmePath, "UTF-8")
        
        Exporter_Log("READMEç”ŸæˆæˆåŠŸ: " readmePath)
        return true
    } catch error {
        Exporter_Log("READMEç”Ÿæˆå¤±è´¥: " error.message)
        return false
    }
}

; æ„å»ºREADMEå†…å®¹
Exporter_BuildReadmeContent(configName) {
    content := ""
    content .= "# Game Macroé…ç½®åŒ…`n`n"
    content .= "## é…ç½®ä¿¡æ¯`n`n"
    content .= "- **é…ç½®æ–‡ä»¶**: " configName ".ini`n"
    content .= "- **å¯¼å‡ºæ—¶é—´**: " FormatTime(A_Now, "yyyy-MM-dd HH:mm:ss") "`n"
    content .= "- **ç‰ˆæœ¬**: 1.0`n`n"
    
    content .= "## ä½¿ç”¨è¯´æ˜`n`n"
    content .= "### 1. æ–‡ä»¶ç»“æ„`n`n"
    content .= "````n"
    content .= "â”œâ”€â”€ scripts/          # ä¸»è„šæœ¬æ–‡ä»¶`n"
    content .= "â”œâ”€â”€ config/           # é…ç½®æ–‡ä»¶ç›®å½•`n"
    content .= "â”œâ”€â”€ worker/           # WorkerHostæ–‡ä»¶`n"
    content .= "â””â”€â”€ docs/             # è¯´æ˜æ–‡æ¡£`n"
    content .= "````n`n"
    
    content .= "### 2. ä½¿ç”¨æ–¹æ³•`n`n"
    content .= "1. åŒå‡»è¿è¡Œ `scripts\`" FileBase(A_ScriptName) ".ahk` æ–‡ä»¶`n"
    content .= "2. é…ç½®ä¼šè‡ªåŠ¨åŠ è½½ `config\`" configName ".ini` æ–‡ä»¶`n"
    content .= "3. WorkerHostä½äº `worker\` ç›®å½•ï¼Œç”¨äºå¤„ç†åå°ä»»åŠ¡`n`n"
    
    content .= "### 3. æ³¨æ„äº‹é¡¹`n`n"
    content .= "- è¯·ç¡®ä¿æ‰€æœ‰æ–‡ä»¶åœ¨åŒä¸€ç›®å½•ä¸‹`n"
    content .= "- é¦–æ¬¡è¿è¡Œå¯èƒ½éœ€è¦ç®¡ç†å‘˜æƒé™`n"
    content .= "- å¦‚æœ‰é—®é¢˜è¯·æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶`n`n"
    
    content .= "### 4. é…ç½®è¯´æ˜`n`n"
    content .= "è¯¦ç»†çš„é…ç½®é€‰é¡¹è¯·å‚è€ƒåŸå§‹é…ç½®æ–‡ä»¶çš„æ³¨é‡Šè¯´æ˜ã€‚`n`n"
    
    return content
}
```

### è¾…åŠ©åŠŸèƒ½

#### è·¯å¾„éªŒè¯

**Exporter_ValidateTargetPath()**
```autohotkey
; éªŒè¯ç›®æ ‡è·¯å¾„
Exporter_ValidateTargetPath(targetPath) {
    try {
        ; æ£€æŸ¥è·¯å¾„æ˜¯å¦æœ‰æ•ˆ
        if targetPath == "" {
            Exporter_Log("ç›®æ ‡è·¯å¾„ä¸èƒ½ä¸ºç©º")
            return false
        }
        
        ; åˆ›å»ºçˆ¶ç›®å½•ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
        parentDir := DirName(targetPath)
        if !DirExist(parentDir) {
            try {
                DirCreate(parentDir)
            } catch error {
                Exporter_Log("åˆ›å»ºçˆ¶ç›®å½•å¤±è´¥: " parentDir " - " error.message)
                return false
            }
        }
        
        ; æ£€æŸ¥ç›®å½•æ˜¯å¦å¯å†™
        testFile := targetPath "\.write_test"
        try {
            FileAppend("", testFile)
            FileDelete(testFile)
        } catch {
            Exporter_Log("ç›®æ ‡ç›®å½•ä¸å¯å†™: " targetPath)
            return false
        }
        
        return true
    } catch error {
        Exporter_Log("è·¯å¾„éªŒè¯å¼‚å¸¸: " error.message)
        return false
    }
}
```

#### é…ç½®è·¯å¾„æ›´æ–°

**Exporter_UpdateConfigPath()**
```autohotkey
; æ›´æ–°é…ç½®æ–‡ä»¶è·¯å¾„å¼•ç”¨
Exporter_UpdateConfigPath(scriptFile, newConfigPath) {
    try {
        ; è¯»å–è„šæœ¬å†…å®¹
        content := FileRead(scriptFile, "UTF-8")
        
        ; æ›¿æ¢é…ç½®æ–‡ä»¶è·¯å¾„
        oldPatterns := [
            "A_ScriptDir",
            ".*\\config\\",
            "\.\.\\config"
        ]
        
        for pattern in oldPatterns {
            if RegExMatch(content, pattern) {
                content := RegExReplace(content, pattern, newConfigPath)
                break
            }
        }
        
        ; å†™å›æ–‡ä»¶
        FileDelete(scriptFile)
        FileAppend(content, scriptFile, "UTF-8")
        
        return true
    } catch error {
        Exporter_Log("æ›´æ–°é…ç½®è·¯å¾„å¤±è´¥: " error.message)
        return false
    }
}
```

#### æ—¥å¿—è®°å½•

**Exporter_Log()**
```autohotkey
; å¯¼å‡ºç³»ç»Ÿæ—¥å¿—è®°å½•
Exporter_Log(message) {
    timestamp := FormatTime(A_Now, "yyyy-MM-dd HH:mm:ss")
    logEntry := "[" timestamp "] [Exporter] " message "`n"
    
    try {
        ; è¿½åŠ åˆ°æ—¥å¿—æ–‡ä»¶
        logPath := A_ScriptDir "\logs\exporter.log"
        if !DirExist(A_ScriptDir "\logs") {
            DirCreate(A_ScriptDir "\logs")
        }
        
        FileAppend(logEntry, logPath, "UTF-8")
    } catch {
        ; æ—¥å¿—è®°å½•å¤±è´¥ä¸å½±å“ä¸»åŠŸèƒ½
    }
}
```

## 4. é…ç½®éªŒè¯ä¸å®‰å…¨

### é…ç½®éªŒè¯æœºåˆ¶

**å®Œæ•´æ€§æ£€æŸ¥**:
```autohotkey
; éªŒè¯é…ç½®æ–‡ä»¶å®Œæ•´æ€§
Storage_ValidateProfile(profile) {
    requiredSections := ["General", "Skills", "Spots"]
    
    ; æ£€æŸ¥å¿…éœ€çš„é…ç½®èŠ‚
    for section in requiredSections {
        if !profile.Has(section) {
            Storage_Log("ç¼ºå°‘å¿…éœ€é…ç½®èŠ‚: " section)
            return false
        }
    }
    
    ; éªŒè¯æ•°æ®ç±»å‹
    if !Storage_ValidateDataTypes(profile) {
        return false
    }
    
    ; éªŒè¯ä¸šåŠ¡é€»è¾‘
    if !Storage_ValidateBusinessRules(profile) {
        return false
    }
    
    return true
}

; éªŒè¯æ•°æ®ç±»å‹
Storage_ValidateDataTypes(profile) {
    try {
        ; éªŒè¯æ•°å€¼ç±»å‹
        for sectionName, sectionData in profile {
            for key, value in sectionData {
                if (key == "Cooldown" || key == "CastTime") {
                    if !IsNumber(value) {
                        Storage_Log("æ— æ•ˆæ•°å€¼ç±»å‹: " sectionName "." key)
                        return false
                    }
                }
            }
        }
        
        return true
    } catch {
        return false
    }
}
```

### å®‰å…¨æœºåˆ¶

**æ•°æ®åŠ å¯†**:
```autohotkey
; åŠ å¯†æ•æ„Ÿé…ç½®æ•°æ®
Storage_EncryptSensitiveData(data) {
    ; è¿™é‡Œå¯ä»¥å®ç°æ•°æ®åŠ å¯†é€»è¾‘
    ; ä½¿ç”¨å¯¹ç§°åŠ å¯†ç®—æ³•ä¿æŠ¤æ•æ„Ÿä¿¡æ¯
    ; è¿”å›åŠ å¯†åçš„æ•°æ®
    return data
}

; è§£å¯†æ•æ„Ÿé…ç½®æ•°æ®
Storage_DecryptSensitiveData(encryptedData) {
    ; å¯¹åº”çš„è§£å¯†é€»è¾‘
    ; è¿”å›è§£å¯†åçš„æ•°æ®
    return encryptedData
}
```

## 5. æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜æœºåˆ¶

**é…ç½®ç¼“å­˜**:
```autohotkey
; å¯ç”¨é…ç½®ç¼“å­˜
Storage_EnableCache() {
    global Storage
    
    Storage.CacheEnabled := true
    Storage.Cache := Map()
    
    Storage_Log("é…ç½®ç¼“å­˜å·²å¯ç”¨")
}

; ç¼“å­˜é…ç½®æ•°æ®
Storage_CacheConfig(configName, data) {
    global Storage
    
    if Storage.CacheEnabled && Storage.Cache.Has(configName) {
        Storage.Cache[configName] := {
            Data: data,
            Timestamp: A_TickCount,
            TTL: 300000  ; 5åˆ†é’Ÿç¼“å­˜
        }
    }
}
```

### å¼‚æ­¥åŠ è½½

**åå°åŠ è½½**:
```autohotkey
; å¼‚æ­¥åŠ è½½é…ç½®æ–‡ä»¶
Storage_LoadConfigAsync(configName, callback) {
    ; åˆ›å»ºå¼‚æ­¥ä»»åŠ¡
    task := { ConfigName: configName, Callback: callback }
    
    ; æ”¾å…¥å¼‚æ­¥é˜Ÿåˆ—
    Storage.AsyncQueue ??= []
    Storage.AsyncQueue.Push(task)
    
    ; å¯åŠ¨å¼‚æ­¥å¤„ç†
    if !Storage.AsyncProcessing {
        Storage_ProcessAsyncQueue()
    }
}
```

## æ€»ç»“

é…ç½®å­˜å‚¨ç³»ç»Ÿæä¾›äº†å®Œæ•´çš„é…ç½®ç®¡ç†è§£å†³æ–¹æ¡ˆï¼Œå…·å¤‡ä»¥ä¸‹æ ¸å¿ƒèƒ½åŠ›ï¼š

**æ ¸å¿ƒä¼˜åŠ¿**:
- âœ… åˆ†å±‚å­˜å‚¨æ¶æ„ï¼Œæ”¯æŒå¤šç§é…ç½®æ ¼å¼
- âœ… å®Œæ•´çš„CRUDæ“ä½œå’Œäº‹åŠ¡æ”¯æŒ
- âœ… è‡ªåŠ¨å¤‡ä»½å’Œæ¢å¤æœºåˆ¶
- âœ… ç±»å‹å®‰å…¨å’Œæ•°æ®éªŒè¯
- âœ… æ€§èƒ½ä¼˜åŒ–å’Œç¼“å­˜æ”¯æŒ
- âœ… çµæ´»çš„å¯¼å‡ºå’Œéƒ¨ç½²åŠŸèƒ½

**æŠ€æœ¯ç‰¹æ€§**:
- **å¤šæ–‡ä»¶ç®¡ç†**: æ”¯æŒåŒæ—¶ç®¡ç†å¤šä¸ªé…ç½®æ–‡ä»¶
- **ç»“æ„åŒ–å­˜å‚¨**: å¤æ‚çš„åµŒå¥—é…ç½®ç»“æ„æ”¯æŒ
- **çƒ­æ›´æ–°**: æ— éœ€é‡å¯çš„é…ç½®çƒ­æ›´æ–°
- **ç‰ˆæœ¬æ§åˆ¶**: é…ç½®æ–‡ä»¶çš„ç‰ˆæœ¬ç®¡ç†
- **å®‰å…¨ä¿æŠ¤**: æ•æ„Ÿæ•°æ®åŠ å¯†å’Œå®‰å…¨éªŒè¯

**åº”ç”¨ä»·å€¼**:
- ä¸ºGame Macroæä¾›å¯é çš„æ•°æ®æŒä¹…åŒ–æ–¹æ¡ˆ
- æ”¯æŒå¤æ‚çš„è§’è‰²é…ç½®å’ŒæŠ€èƒ½ç®¡ç†éœ€æ±‚
- æä¾›å®Œæ•´çš„é…ç½®å¤‡ä»½å’Œæ¢å¤ä¿éšœ
- å®ç°çµæ´»çš„é…ç½®æ–‡ä»¶å¯¼å‡ºå’Œéƒ¨ç½²æœºåˆ¶
- æ”¯æŒå¤šç”¨æˆ·ã€å¤šé…ç½®çš„å¹¶å‘ç®¡ç†

**æ‰©å±•å»ºè®®**:
- å¢åŠ æ•°æ®åº“å­˜å‚¨æ”¯æŒï¼ˆSQLite/MySQLï¼‰
- å®ç°é…ç½®æ¨¡æ¿å’Œå¿«é€Ÿç”ŸæˆåŠŸèƒ½
- æ·»åŠ é…ç½®ç‰ˆæœ¬æ§åˆ¶å’Œå˜æ›´è¿½è¸ª
- æ”¯æŒäº‘ç«¯é…ç½®åŒæ­¥å’Œå¤‡ä»½
- å®ç°æ›´ä¸°å¯Œçš„é…ç½®éªŒè¯è§„åˆ™

---

*ğŸ“ æœ€åæ›´æ–°: 2025-11-29*  
*ğŸ”„ æ–‡æ¡£ç‰ˆæœ¬: v1.1*  
*ğŸ‘¨â€ğŸ’» ç»´æŠ¤å›¢é˜Ÿ: Game Macroå¼€å‘ç»„*